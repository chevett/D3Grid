(function(n,t,i){function e(n){if(typeof n.dataUrl!="string")throw"d3G.Grid: `dataUrl` must be a string (url)!";}function f(r){function h(){var t=n.extend({},o.getSortParameters(),u.getPageParameters());return typeof r.customParams=="function"&&(t=r.customParams(t)),t}function s(t){t=t||h(),n.ajax({url:r.dataUrl,data:t,dataType:"json",traditional:!0,type:"POST"}).done(function(n){f[t.PageIndex]=n,o.render(n),u.render(n)}).fail(function(){})}function c(){var t=h(),n;f[t.PageIndex]?(n=f[t.PageIndex],o.render(n),u.render(n)):s(t)}t.select(r.containerSelector).classed("d3g-container loading-content-container",!0),e(r);var o=i.Grid.Table.create(r),u=i.Grid.Pager.create(r),f;return o.sortColumnChanged.addHandler(function(){f={},u.reset(),s()}),u.pageChanged.addHandler(function(){c()}),u.pageSizeChanged.addHandler(function(){f={},u.reset(),s()}),{table:o,pager:u,render:function(){f={},u.reset(),s()}}}i.Grid={create:f}})(window.jQuery,window.d3,window.d3G||{},window),function(n,t,i,r){function s(n){n.tableTitle&&t.select(n.containerSelector).insert("div",n.tableSelector).classed("d3g-header",!0).append("span").attr("id",n.tableSelector.replace(/#/gi,"")+"Header").html(n.tableTitle)}function o(n){var t=n.tableStyling||{},i="table d3g-table",f=typeof t.bordered!="undefined"?t.bordered:!0,e=typeof t.bordered!="undefined"?t.condensed:!1,r=typeof t.striped!="undefined"?t.striped:!0,u=typeof t.hovered!="undefined"?t.hovered:!0;return i+=f?" table-bordered":"",i+=e?" table-condensed":"",i+=r?" table-striped":"",i+=u?" table-hovered":""}function e(i){s(i),n(i.tableSelector).wrap('<div class="d3g-table-wrapper" />');var h=n.Callbacks(),e=i.defaultSortColumn||"",f=i.defaultSortDirection&&i.defaultSortDirection==="Descending"?!1:!0,u={PlainText:function(n){return n},Number:function(n){return n},Currency:function(n){return n},Html:function(t){return n("<div />").html(t).text()},Handlebars:function(){var t={};return function(i,u){var f=t[i]||(t[i]=r.compile(n("<div />").html(i).text()));return f(u)}}()};u=n.extend(i.formatters||{},u);n(i.tableSelector).on("click","th.d3g-sortable",function(){var t=n(this),r=t.data("sort-column"),i=t.hasClass("d3g-sort-active");e=r,f=i?!f:!0,h.fire()});if(i.onCellClick)n(i.tableSelector).on("click","tbody tr td",function(){var n=this;i.onCellClick(n)});return{render:function(r){var h=n.grep(r.columns,function(n){return n.includeType==="Column"}),v=n(i.tableSelector);v.empty();var a=o(i),s=t.select(i.tableSelector).classed(a,!0),p=s.append("thead").classed("d3g-table-header",!0).append("tr").selectAll("th").data(h).enter().append("th").attr("class",function(n){var t="d3g-header-"+n.index;return n.isSortable===!0&&(t=t+" d3g-sortable"),n.sortColumnName===e&&(t=t+" d3g-sort-active",t=f?t+" d3g-sort-asc":t+" d3g-sort-desc"),t}).attr("data-sort-column",function(n){if(n.isSortable===!0)return n.sortColumnName}).html(function(n){var t=n.label;return n.isSortable===!0&&(t+='<span class="text-icon d3g-sort-icon"></span>'),t}),c=s.append("tbody"),l=c.selectAll("tr").data(r.rows).enter().append("tr"),y=l.selectAll("td").data(h).enter().append("td").attr("class",function(n){return"d3g-content-"+n.index}).html(function(n,t,i){var s=n.name,e=r.rows[i],o=e[s],f;return u.custom&&(f=u.custom[s],typeof f=="function")?f(o,e):(f=n.formatter,typeof f=="function")?f(o,e):u[n.format](o,e)})},sortColumnChanged:{addHandler:function(n){h.add(n)},removeHandler:function(n){h.remove(n)}},getSortParameters:function(){return{SortColumnName:e,SortOrder:f?"Ascending":"Descending"}}}}i.Grid.Table={create:e}}(window.jQuery,window.d3,window.d3G,window.Handlebars||{},window);var d3G=d3G||{};d3G.Grid=d3G.Grid||{},d3G.Grid.Pager=function(n,t,i,r){function f(i){function y(i){var l={classed:"d3g-pager-sizer-wrapper"},h={classed:"d3g-pager-sizer-text"},p={classed:"d3g-pager-sizer-select-wrapper"},y={classed:"d3g-pager-sizer"},v={classed:"d3g-pager-sizer-text-prepend"},r=u(i,l),w=u(r,h,"span"),s,e,f;w.text("Showing"),s=u(r,p),e=u(s,y,"select"),e.on("change",function(){t.event.preventDefault(),o=n(this).val(),c.fire()}).selectAll("option").data(a).enter().append("option").attr("val",function(n){return n}).text(function(n){return n}).filter(function(n){return n===o}).attr("selected","selected"),f=u(r,v,"span"),f.text("per page")}function w(n){var r={classed:"d3g-pager-nav"},i=[{Label:"First",Icon:"d3g-first",UpdatePageIndex:function(){f=0}},{Label:"Previous",Icon:"d3g-previous",UpdatePageIndex:function(){f!==0&&(f-=1)}},{Label:"Next",Icon:"d3g-next",UpdatePageIndex:function(){f!==e-1&&(f+=1)}},{Label:"Last",Icon:"d3g-last",UpdatePageIndex:function(){f=e-1}}],o=u(n,r);n.select(".d3g-pager-nav").selectAll("a").data(i).enter().append("a").attr("href","#").attr("class",function(n){return"text-icon "+n.Icon}).text(function(n){return n.Label}).on("click",function(n){t.event.preventDefault(),n.UpdatePageIndex(),h.fire()})}function b(i){var s={classed:"d3g-pager-fullscreen"},e={classed:"d3g-pager-fullscreen-message"},o=u(i,s,"a"),f;o.classed("icon",!0).text("fullscreen Mode").on("click",function(){t.event.preventDefault();var u=n(this).parents(".d3g-container");u.toggleClass("d3g-fullscreen"),n(r).bind("resize",function(){l(u)}),u.hasClass("d3g-fullscreen")?l(u):(n(".d3g-table-wrapper").css("height","auto"),n(r).unbind("resize"))});f=u(i,e),f.text("Press `ESC` To Exit Fullscreen Mode"),n(r).keyup(function(t){t.keyCode===27&&n(".d3g-container").removeClass("d3g-fullscreen")})}function k(n){var r={classed:"d3g-pager-message"},o=u(n,r),f=[{Selector:"d3g-pager-message-title",Content:"Page "},{Selector:"d3g-pager-message-input",Content:s},{Selector:"d3g-pager-seperator",Content:" of "},{Selector:"d3g-pager-message-total-pages",Content:e}],i=o.selectAll("span").data(f);i.enter().append("span").attr("class",function(n){return n.Selector}),i.text(function(n){return n.Content})}function p(n,t){var s={classed:"d3g-pager-toolbar"},e={classed:"d3g-pager-toolbar-tools"},r=u(n,s),o=u(r,e),f;t.footerText&&v(r,t.footerText),f=typeof i.canFullScreen!="undefined"?i.fullscreen:!0,f&&b(o)}function v(n,t){var r={classed:"d3g-pager-footer-text",content:t},i={};i=u(n,r),i.text(r.content)}function l(t){var e=n(i.pagerSelector).height(),f=n(".d3g-header"),u;f&&(e+=f.height()),u=n(r).height()-e,t.find(".d3g-table-wrapper").css("height",u)}function u(n,t,i){i=i||"div";var r=n.selectAll("."+t.classed).data([t]);return r.enter().append(i).attr("class",function(n){return n.classed}),r}var a=[10,20,50],f=0,o=a[0],h=n.Callbacks(),c=n.Callbacks(),e=0,s=0;return{render:function(n){var h={},c=[{classed:"d3g-pager-wrapper"}],l={classed:"d3g-pager-top-wrapper"},r={};h=t.select(i.pagerSelector).classed("d3g-pager",!0).selectAll("div").data(c),h.enter().append("div").attr("class",function(n){return n.classed}),r=u(h,l),e=Math.ceil(n.totalRowCount/o),s=f+1,w(r),y(r),k(r,n),p(h,n)},pageChanged:{addHandler:function(n){h.add(n)},removeHandler:function(n){h.remove(n)}},pageSizeChanged:{addHandler:function(n){c.add(n)},removeHandler:function(n){c.remove(n)}},getPageParameters:function(){return{PageIndex:f,PageSize:o}},reset:function(){e=0,s=1,f=0}}}i.Grid.Pager={create:f}}(window.jQuery,window.d3,window.d3G,window)